{% extends 'explore/base.html' %}

{%- from 'explore/partials/article-blocks.html' import articleBlocks -%}
{%- from 'explore/partials/article-footer.html' import articleFooter -%}
{%- from 'explore/partials/article-sidebar.html' import articleSidebar -%}
{%- from 'components/breadcrumbs/macro.html' import tnaBreadcrumbs -%}
{%- from 'components/card/macro.html' import tnaCard -%}
{%- from 'components/hero/macro.html' import tnaHero -%}
{%- from 'components/index-grid/macro.html' import tnaIndexGrid -%}
{%- from 'components/picture/macro.html' import tnaPicture -%}
{%- from 'components/warning/macro.html' import tnaWarning -%}
{%- from 'macros/feedback.html' import feedback -%}

{%- set themeAccent = 'pink' -%}
{%- set bodyClasses = 'tna-template__body--focused-article' -%}

{% block stylesheets %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='article.css') }}">
{% endblock %}

{% block beforeContent %}
{% if breadcrumbs and breadcrumbs | length > 0 %}
<div class="tna-background-accent">
  <div class="tna-container">
    <div class="tna-column tna-column--full">
      {{ tnaBreadcrumbs({
        'items': breadcrumbs,
        'structuredData': True
      }) }}
    </div>
  </div>
</div>
{% endif %}
{% endblock %}

{% block content %}
<article class="etna-article" itemscope itemtype="https://schema.org/Article">
  <meta itemprop="datePublished" content="{{ page_data.meta.first_published_at }}">
  <!-- <div class="tna-background-accent">
    <header class="tna-section tna-!--padding-bottom-xl">
      <div class="tna-container">
        <div class="tna-column tna-column--width-2-3 tna-column--width-5-6-medium tna-column--full-small tna-column--full-tiny">
          <hgroup class="tna-hgroup-xl">
            <p class="tna-hgroup__supertitle">{{ page_data.meta.type | article_supertitle }}</p>
            <h1 class="tna-hgroup__title" itemprop="name">{{ page_data.title }}</h1>
          </hgroup>
          <div class="tna-large-paragraph tna-!--margin-top-s" itemprop="headline">
            {{ page_data.intro | safe }}
          </div>
        </div>
        <div class="tna-column tna-column--full">
          {% if page_data.authors | length %}
          <div class="etna-author-list">
            <h2 class="etna-author-list__heading tna-chip tna-chip--plain tna-visually-hidden">Author{{ 's' if authors | length > 1 }}</h2>
            <ul class="etna-author-list__items tna-columns tna-columns--3 tna-columns--2-small tna-columns--1-tiny">
              {% for author in page_data.authors %}
              <li class="etna-author-list__item tna-columns__block" itemprop="author" itemscope itemtype="https://schema.org/Person">
                <img src="{{ author.image.jpeg.full_url }}" alt="{{ author.image.alt or 'TODO' }}" width="{{ author.image.jpeg.width }}" height="{{ author.image.jpeg.height }}" class="etna-author-list__image etna-author-image etna-author-image--small" itemprop="image">
                <p class="etna-author-list__name">
                  <strong>
                    <link itemprop="url" href="{{ author.url }}">
                    <a href="{{ author.url }}" rel="author">
                      <span itemprop="name">{{ author.title }}</span>
                    </a>
                  </strong>
                </p>
                <p class="etna-author-list__description" itemprop="jobTitle">{{ author.role }}</p>
              </li>
              {% endfor %}
            </ul>
          </div>
          {% endif %}
        </div>
      </div>
    </header>
  </div>
  {% if page_data.hero_image_jpg %}
  <div class="etna-background-half-top-accent">
    <div class="tna-container">
      <div class="tna-column tna-column--full">
        {{ tnaHero({
          'imageSrc': page_data.hero_image_jpg.full_url,
          'imageAlt': page_data.hero_image_jpg.alt,
          'imageWidth': page_data.hero_image_jpg.width,
          'imageHeight': page_data.hero_image_jpg.height,
          'imageSources': [
            {
              'src': page_data.hero_image_jpg_small.full_url,
              'media': "(max-width: 48em)",
              'width': page_data.hero_image_jpg_small.width,
              'height': page_data.hero_image_jpg_small.height,
              'type': "image/jpeg"
            }
          ],
          'imageCaption': page_data.hero_image_caption | safe
        }) }}
      </div>
    </div>
  </div>
  {% endif %} -->





  {% if page_data.hero_image and page_data.hero_image_small %}
  <div class="tna-background-accent-light">
    {{ tnaHero({
      'supertitle': page_data.type_label,
      'title': page_data.title,
      'body_': ('<div class="tna-large-paragraph" itemprop="headline">' + page_data.intro + '</div>') | safe,
      'imageSrc': page_data.hero_image.jpeg.full_url,
      'imageAlt': page_data.hero_image.alt_text,
      'imageWidth': page_data.hero_image.jpeg.width,
      'imageHeight': page_data.hero_image.jpeg.height,
      'imageCaption': page_data.hero_image_caption,
      'imageSources': [
        {
          'src': page_data.hero_image_small.webp.full_url,
          'width': page_data.hero_image_small.webp.width,
          'height': page_data.hero_image_small.webp.height,
          'type': 'image/webp',
          'media': '(max-width: 48em)'
        },
        {
          'src': page_data.hero_image_small.jpeg.full_url,
          'width': page_data.hero_image_small.jpeg.width,
          'height': page_data.hero_image_small.jpeg.height,
          'type': 'image/jpeg',
          'media': '(max-width: 48em)'
        },
        {
          'src': page_data.hero_image.webp.full_url,
          'width': page_data.hero_image.webp.width,
          'height': page_data.hero_image.webp.height,
          'type': 'image/webp'
        }
      ],
      'style': 'accent',
      'layout': 'shift'
    }) }}
    <div class="tna-container tna-!--padding-bottom-s">
      <div class="tna-column tna-column--width-2-3 tna-column--width-5-6-medium tna-column--full-small tna-column--full-tiny">
        <div class="tna-large-paragraph tna-!--margin-top-l" itemprop="headline">
          {{ page_data.intro | safe }}
        </div>
      </div>
    </div>
  </div>
  {% else %}
  <div class="tna-background-accent">
    <header class="tna-section tna-!--padding-bottom-xl">
      <div class="tna-container">
        <div class="tna-column tna-column--width-2-3{{ ' tna-column--width-5-6-medium' if not page_data.authors | length }} tna-column--full-small tna-column--full-tiny">
          <hgroup class="tna-hgroup-xl">
            <p class="tna-hgroup__supertitle">{{ page_data.meta.type | article_supertitle }}</p>
            <h1 class="tna-hgroup__title" itemprop="name">{{ page_data.title }}</h1>
          </hgroup>
          <div class="tna-large-paragraph tna-!--margin-top-l" itemprop="headline">
            {{ page_data.intro | safe }}
          </div>
        </div>
      </div>
    </header>
  </div>
  {% endif %}

  {% if page_data.authors | length %}
  <div class="tna-background-accent-light tna-!--padding-top-s">
    <div class="tna-container">
      <div class="etna-author-list etna-author-list--horizontal tna-column tna-column--full">
        <h2 class="etna-author-list__heading tna-heading-s">Author{{ 's' if page_data.authors | length > 1 }}</h2>
        <ul class="etna-author-list__items">
          {% for author in page_data.authors %}
          <li class="etna-author-list__item" itemprop="author" itemscope itemtype="https://schema.org/Person">
            <img src="{{ author.image.jpeg.full_url }}" alt="{{ author.image.alt_text }}" width="{{ author.image.jpeg.width }}" height="{{ author.image.jpeg.height }}" class="etna-author-list__image" itemprop="image">
            <div class="etna-author-list__details">
              <p class="etna-author-list__name">
                <strong>
                  <link itemprop="url" href="{{ author.url }}">
                  <a href="{{ author.url }}" rel="author">
                    <span itemprop="name">{{ author.title }}</span>
                  </a>
                </strong>
              </p>
              <p class="etna-author-list__description" itemprop="jobTitle">{{ author.role }}</p>
            </div>
          </li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
  {% endif %}

  <section class="tna-section">
    <div class="tna-container">
      <div class="tna-column tna-column--width-1-4 tna-column--width-1-3-medium tna-column--full-small tna-column--full-tiny">
        {{ articleSidebar(page_data.body) }}
      </div>
      <div class="tna-column tna-column--width-3-4 tna-column--width-2-3-medium tna-column--full-small tna-column--full-tiny etna-article__sections" itemprop="articleBody">
        {% if page_data.display_content_warning %}
        {{ tnaWarning({
          'headingLevel': 2,
          'body': page_data.custom_warning_text | safe or 'This article contains content that some people may find offensive.',
          'classes': 'tna-!--margin-top-s tna-!--margin-bottom-m'
        }) }}
        {% endif %}
        {{ articleBlocks(page_data.body, merge_dict_if) }}
      </div>
      <!-- <div class="tna-column tna-column--full tna-!--margin-top-m">
        <p>
          <small>&quot;{{ page_data.meta.type | article_supertitle }} {{ page_data.title }}&quot; was first published on <time datetime="{{ page_data.meta.first_published_at }}" itemprop="datePublished">{{ page_data.meta.first_published_at | pretty_date }}</time>.</small>
        </p>
      </div> -->
    </div>
  </section>
  <aside>
    {{ articleFooter(page_data.similar_items, categories, page_data.latest_items) }}
  </aside>
</article>

{{ feedback() }}
{% endblock %}

{% block bodyEnd %}
<script src="{{ url_for('static', filename='article.min.js') }}"></script>
{{ super() }}
{% endblock %}
